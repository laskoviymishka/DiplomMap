@model IEnumerable<MongoRepository.Model.Region>
@{
    ViewBag.Title = "Index";
    int idIndex = 0;
}
<link href="../../Content/jquery.dataTables.css" rel="stylesheet" type="text/css" />
<link href="../../Content/demo_table.css" rel="stylesheet" type="text/css" />
<link href="../../Content/demo_page.css" rel="stylesheet" type="text/css" />
<script src="../../Content/jquery.dataTables.min.js" type="text/javascript"></script>
<script>
    $(document).ready(function () {
        $('#main-table').dataTable();
    });
</script>
<table id="main-table" class="table table-striped table-condensed">
    <thead>
        <th>
            Регион
        </th>
        <th>
            Латинское название
        </th>
        <th>
            Агрегирующий параметр
        </th>
        <th>
            Динамика параметра параметр
        </th>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            foreach (var inner in item.Parametrs)
            {
                foreach (var child in inner.ChildParametrs)
                {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.RegionName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.EnglishName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => inner.ParametrName)
                </td>
                <td>
                    <div>
                    @{idIndex++;}
                        <div>
                            <button onclick="ShowEdit('@string.Format("/Region/ChildParametr/{0}/{1}", item._id, child.ParametrName.GetHashCode())',@idIndex)" class="btn" style="margin:3px;">@child.ParametrName</button>
                        </div>
                        <div id="@idIndex" style="margin:3px; width:100%; display:none">
                        </div>
                    </div>
                </td>
            </tr>
                }
            }
        }
    </tbody>
</table>
<div class="modal" id="myModal" style="height: 85%; width: 750px">
    <div class="modal-header">
        <button class="close" data-dismiss="modal">
            ×</button>
    </div>
    <div id="modalContent" style="height: 90%; width: 100%; overflow-y: auto; overflow-x: hidden">
    </div>
</div>
<script type="text/javascript">
    ShowEdit = function (link, index) {
        var index = '#' + index
        $.get(link, function (data) {
            $(index).html(data)
            $(index).toggle('roll')
        })
    }
</script>
<script>
    ShowPopUp = function (link) {
        $('#modalContent').html("загружаются данные");
        $.get(link, function (data) {
            $('#modalContent').html(data);
        })

        $('#myModal').modal()
    }

    $('#myModal').modal()
    $('#myModal').modal('hide')
</script>
