@model MongoRepository.Model.EditParametrViewModel
@{
    var guid = new Guid();
}
<p>@Model.ParametrName</p>
<div>
    @using (Ajax.BeginForm(null, null, new AjaxOptions { HttpMethod = "POST" }, new { id = guid.ToString() }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        @Html.HiddenFor(model => model.ParametrName)
        @Html.HiddenFor(model => model.RegionId)
        <fieldset>
            <table class="table table-striped table-condensed">
                <thead>
                    <tr>
                        <th>Год
                        </th>
                        <th>Значение
                        </th>
                    </tr>
                </thead>
                <tbody id="@Model.ParametrName.GetHashCode()-table">
                    @for (int i = 0; i < Model.Values.Count(); i++)
                    {
                        <tr id="@Model.ParametrName.GetHashCode()-@i">
                            <td>
                                @Html.EditorFor(modelItem => Model.Values.ToArray()[i].Key)
                            </td>

                            <td>
                                @Html.EditorFor(modelItem => Model.Values.ToArray()[i].Value)
                            </td>
                            <td>
                                <div class="btn-alert" onclick="removeValue('@Model.ParametrName.GetHashCode()-@i')">Х</div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
            <p>
                <input type="submit" value="Save" />
            </p>
        </fieldset>
    }
</div>
<button class="btn" onclick="addValue('@Model.ParametrName.GetHashCode()-table')">Добавить значение</button>

<script type="text/javascript">
    addValue = function (data) {
        var index = @Model.Values.Count();
        var id = '#' + data + ':last';
        $(id).append('<tr><td><input class="text-box single-line" data-val="true" data-val-number="The field Key must be a number." data-val-required="The Key field is required." name="[' + index + '].Key" type="number" value="0"></td><td><input class="text-box single-line" data-val="true" data-val-number="The field Value must be a number." data-val-required="The Value field is required." name="[' + index + '].Value" type="text" value="0"></td></tr>');
    }
    
    removeValue = function(data) {
        var id = '#' + data;
        $(id).remove();
    }
</script>
